# -*- coding: utf-8 -*-
from scrapy.selector import Selector
from zhihu.items import ZhiHuItem
from zhihu.settings import MySQL
from random import randint
from imysql import DB
import scrapy
import json
import codecs
import time

class one(scrapy.Spider):
    name = "one"
    base_url = 'https://www.zhihu.com'
    allowed_domains = ["www.zhihu.com"]
    # 游戏 game
    start_urls = [
       # "https://www.zhihu.com/topic/19550994/followers",
       # "https://www.zhihu.com/topic/19553732/followers",
       # "https://www.zhihu.com/topic/19563451/followers",
       # "https://www.zhihu.com/topic/19551296/followers",
       # "https://www.zhihu.com/topic/19555490/followers",
       # "https://www.zhihu.com/topic/19605346/followers",
       # "https://www.zhihu.com/topic/19551648/followers",
       # "https://www.zhihu.com/topic/19551292/followers",
       # "https://www.zhihu.com/topic/19564520/followers",
       # "https://www.zhihu.com/topic/19555033/followers",
       # "https://www.zhihu.com/topic/19563447/followers",
       # "https://www.zhihu.com/topic/19638453/followers",
       # "https://www.zhihu.com/topic/19567820/followers",
       # "https://www.zhihu.com/topic/19553361/followers",
       # "https://www.zhihu.com/topic/19554968/followers",
       # "https://www.zhihu.com/topic/19557523/followers",
       # "https://www.zhihu.com/topic/19552397/followers",
       # "https://www.zhihu.com/topic/19551288/followers",
       # "https://www.zhihu.com/topic/19634312/followers",
        "https://www.zhihu.com/topic/19593845/followers",
       # "https://www.zhihu.com/topic/19633026/followers",
       # "https://www.zhihu.com/topic/19825391/followers",
       # "https://www.zhihu.com/topic/19575365/followers",
       # "https://www.zhihu.com/topic/19606664/followers",
       # "https://www.zhihu.com/topic/19797703/followers",
       # "https://www.zhihu.com/topic/19570973/followers",
       # "https://www.zhihu.com/topic/19575364/followers",
       # "https://www.zhihu.com/topic/19598367/followers",
       # "https://www.zhihu.com/topic/19551202/followers",
       # "https://www.zhihu.com/topic/19584076/followers",
       # "https://www.zhihu.com/topic/19551632/followers",
       # "https://www.zhihu.com/topic/19598161/followers",
       # "https://www.zhihu.com/topic/19632626/followers",
       # "https://www.zhihu.com/topic/19573896/followers",
       # "https://www.zhihu.com/topic/19552393/followers",
       # "https://www.zhihu.com/topic/19555407/followers",
       # "https://www.zhihu.com/topic/19555035/followers",
       # "https://www.zhihu.com/topic/19555550/followers",
       # "https://www.zhihu.com/topic/19554188/followers",
       # "https://www.zhihu.com/topic/19561656/followers",
       # "https://www.zhihu.com/topic/19564906/followers",
       # "https://www.zhihu.com/topic/19568806/followers",
       # "https://www.zhihu.com/topic/19552038/followers",
       # "https://www.zhihu.com/topic/19583842/followers",
       # "https://www.zhihu.com/topic/19590019/followers",
       # "https://www.zhihu.com/topic/19600554/followers",
       # "https://www.zhihu.com/topic/19550880/followers",
       # "https://www.zhihu.com/topic/19632659/followers",
       # "https://www.zhihu.com/topic/19660478/followers",
       # "https://www.zhihu.com/topic/19553255/followers",
       # "https://www.zhihu.com/topic/19552479/followers",
       # "https://www.zhihu.com/topic/19625841/followers",
       # "https://www.zhihu.com/topic/19839210/followers",
       # "https://www.zhihu.com/topic/19785574/followers",
       # "https://www.zhihu.com/topic/19670052/followers",
       # "https://www.zhihu.com/topic/19558999/followers",
       # "https://www.zhihu.com/topic/19552043/followers",
       # "https://www.zhihu.com/topic/19556258/followers",
       # "https://www.zhihu.com/topic/19554169/followers",
       # "https://www.zhihu.com/topic/19564209/followers",
       # "https://www.zhihu.com/topic/19646175/followers",
       # "https://www.zhihu.com/topic/19601747/followers",
       # "https://www.zhihu.com/topic/19941427/followers",
       # "https://www.zhihu.com/topic/19554542/followers",
       # "https://www.zhihu.com/topic/19594417/followers",
       # "https://www.zhihu.com/topic/19585025/followers",
       # "https://www.zhihu.com/topic/19550875/followers",
       # "https://www.zhihu.com/topic/19665373/followers",
       # "https://www.zhihu.com/topic/19559555/followers",
       # "https://www.zhihu.com/topic/19612186/followers",
       # "https://www.zhihu.com/topic/19682490/followers",
       # "https://www.zhihu.com/topic/19611203/followers",
       # "https://www.zhihu.com/topic/19665386/followers",
       # "https://www.zhihu.com/topic/19552927/followers",
       # "https://www.zhihu.com/topic/19631371/followers",
       # "https://www.zhihu.com/topic/19551941/followers",
       # "https://www.zhihu.com/topic/19555499/followers",
       # "https://www.zhihu.com/topic/19556069/followers",
       # "https://www.zhihu.com/topic/19551197/followers",
       # "https://www.zhihu.com/topic/19614798/followers",
       # "https://www.zhihu.com/topic/19626875/followers",
       # "https://www.zhihu.com/topic/19556056/followers",
       # "https://www.zhihu.com/topic/19587670/followers",
       # "https://www.zhihu.com/topic/19569353/followers",
       # "https://www.zhihu.com/topic/19563545/followers",
       # "https://www.zhihu.com/topic/19740084/followers",
       # "https://www.zhihu.com/topic/19701004/followers",
       # "https://www.zhihu.com/topic/19618133/followers",
       # "https://www.zhihu.com/topic/19822552/followers",
       # "https://www.zhihu.com/topic/19601882/followers",
       # "https://www.zhihu.com/topic/19633943/followers",
       # "https://www.zhihu.com/topic/19633581/followers",
       # "https://www.zhihu.com/topic/19558989/followers",
       # "https://www.zhihu.com/topic/19570407/followers",
       # "https://www.zhihu.com/topic/19725674/followers",
       # "https://www.zhihu.com/topic/19566188/followers",
       # "https://www.zhihu.com/topic/19684181/followers",
       # "https://www.zhihu.com/topic/19566899/followers",
       # "https://www.zhihu.com/topic/19613402/followers",
       # "https://www.zhihu.com/topic/19604292/followers",
       # "https://www.zhihu.com/topic/19839844/followers",
       # "https://www.zhihu.com/topic/19634582/followers",
       # "https://www.zhihu.com/topic/19652802/followers",
       # "https://www.zhihu.com/topic/19655100/followers",
       # "https://www.zhihu.com/topic/20000751/followers",
       # "https://www.zhihu.com/topic/19860807/followers",
       # "https://www.zhihu.com/topic/19769173/followers",
       # "https://www.zhihu.com/topic/19672960/followers",
       # "https://www.zhihu.com/topic/19621263/followers",
       # "https://www.zhihu.com/topic/19669945/followers",
       # "https://www.zhihu.com/topic/19588013/followers",
       # "https://www.zhihu.com/topic/19643486/followers",
       # "https://www.zhihu.com/topic/19636211/followers",
       # "https://www.zhihu.com/topic/19605364/followers",
       # "https://www.zhihu.com/topic/19659449/followers",
       # "https://www.zhihu.com/topic/19682465/followers",
       # "https://www.zhihu.com/topic/19605321/followers",
       # "https://www.zhihu.com/topic/19550891/followers",
       # "https://www.zhihu.com/topic/19552677/followers",
       # "https://www.zhihu.com/topic/19563896/followers",
       # "https://www.zhihu.com/topic/19564991/followers",
       # "https://www.zhihu.com/topic/19837100/followers",
       # "https://www.zhihu.com/topic/19624459/followers",
       # "https://www.zhihu.com/topic/19874243/followers",
       # "https://www.zhihu.com/topic/19551511/followers",
       # "https://www.zhihu.com/topic/19635879/followers",
       # "https://www.zhihu.com/topic/19832750/followers",
       # "https://www.zhihu.com/topic/19608074/followers",
       # "https://www.zhihu.com/topic/19567296/followers",
       # "https://www.zhihu.com/topic/19585906/followers",
       # "https://www.zhihu.com/topic/19762489/followers",
       # "https://www.zhihu.com/topic/19671434/followers",
       # "https://www.zhihu.com/topic/19800808/followers",
       # "https://www.zhihu.com/topic/19774088/followers",
       # "https://www.zhihu.com/topic/19552924/followers",
       # "https://www.zhihu.com/topic/19770861/followers",
       # "https://www.zhihu.com/topic/19592388/followers",
       # "https://www.zhihu.com/topic/19675977/followers",
       # "https://www.zhihu.com/topic/19579639/followers",
       # "https://www.zhihu.com/topic/19747377/followers",
       # "https://www.zhihu.com/topic/19689496/followers",
       # "https://www.zhihu.com/topic/19556459/followers",
       # "https://www.zhihu.com/topic/19843806/followers",
       # "https://www.zhihu.com/topic/19587999/followers",
       # "https://www.zhihu.com/topic/19641342/followers",
       # "https://www.zhihu.com/topic/19843804/followers",
       # "https://www.zhihu.com/topic/19624885/followers",
       # "https://www.zhihu.com/topic/19937853/followers",
       # "https://www.zhihu.com/topic/19646650/followers",
       # "https://www.zhihu.com/topic/19557539/followers",
       # "https://www.zhihu.com/topic/19572040/followers",
       # "https://www.zhihu.com/topic/19904650/followers",
       # "https://www.zhihu.com/topic/19817120/followers",
       # "https://www.zhihu.com/topic/19723153/followers",
       # "https://www.zhihu.com/topic/19661092/followers",
       # "https://www.zhihu.com/topic/19564140/followers",
       # "https://www.zhihu.com/topic/19813152/followers",
       # "https://www.zhihu.com/topic/19596386/followers",
       # "https://www.zhihu.com/topic/19640522/followers",
       # "https://www.zhihu.com/topic/19605344/followers",
       # "https://www.zhihu.com/topic/19851240/followers",
       # "https://www.zhihu.com/topic/19684423/followers",
       # "https://www.zhihu.com/topic/19655107/followers",
       # "https://www.zhihu.com/topic/19790901/followers",
       # "https://www.zhihu.com/topic/19568492/followers",
       # "https://www.zhihu.com/topic/19648588/followers",
       # "https://www.zhihu.com/topic/20003434/followers",
       # "https://www.zhihu.com/topic/19558758/followers",
       # "https://www.zhihu.com/topic/19632403/followers",
       # "https://www.zhihu.com/topic/19600198/followers",
       # "https://www.zhihu.com/topic/19562894/followers",
       # "https://www.zhihu.com/topic/19579772/followers",
       # "https://www.zhihu.com/topic/19601352/followers",
       # "https://www.zhihu.com/topic/19578702/followers",
       # "https://www.zhihu.com/topic/19564517/followers",
       # "https://www.zhihu.com/topic/19737821/followers",
       # "https://www.zhihu.com/topic/19800861/followers",
       # "https://www.zhihu.com/topic/19574057/followers",
       # "https://www.zhihu.com/topic/19774028/followers",
       # "https://www.zhihu.com/topic/19557753/followers",
       # "https://www.zhihu.com/topic/19840693/followers",
       # "https://www.zhihu.com/topic/19872562/followers",
       # "https://www.zhihu.com/topic/19824967/followers",
       # "https://www.zhihu.com/topic/19591286/followers",
       # "https://www.zhihu.com/topic/19672795/followers",
       # "https://www.zhihu.com/topic/19679416/followers",
       # "https://www.zhihu.com/topic/19872901/followers",
       # "https://www.zhihu.com/topic/19575005/followers",
       # "https://www.zhihu.com/topic/19766087/followers",
       # "https://www.zhihu.com/topic/20006686/followers",
       # "https://www.zhihu.com/topic/19782088/followers",
       # "https://www.zhihu.com/topic/20008251/followers",
       # "https://www.zhihu.com/topic/19580234/followers",
       # "https://www.zhihu.com/topic/19612228/followers",
       # "https://www.zhihu.com/topic/19590529/followers",
       # "https://www.zhihu.com/topic/19574917/followers",
       # "https://www.zhihu.com/topic/19747456/followers",
       # "https://www.zhihu.com/topic/19790230/followers",
       # "https://www.zhihu.com/topic/19574620/followers",
       # "https://www.zhihu.com/topic/19683003/followers",
       # "https://www.zhihu.com/topic/19632070/followers",
       # "https://www.zhihu.com/topic/19663238/followers",
       # "https://www.zhihu.com/topic/19641618/followers",
       # "https://www.zhihu.com/topic/19751551/followers",
       # "https://www.zhihu.com/topic/19834950/followers",
       # "https://www.zhihu.com/topic/19556799/followers",
       # "https://www.zhihu.com/topic/19631362/followers",
       # "https://www.zhihu.com/topic/19554198/followers",
       # "https://www.zhihu.com/topic/19743266/followers",
       # "https://www.zhihu.com/topic/19948326/followers",
       # "https://www.zhihu.com/topic/19885919/followers",
       # "https://www.zhihu.com/topic/19851030/followers",
       # "https://www.zhihu.com/topic/19599764/followers",
       # "https://www.zhihu.com/topic/19746150/followers",
       # "https://www.zhihu.com/topic/19784936/followers",
       # "https://www.zhihu.com/topic/19786309/followers",
       # "https://www.zhihu.com/topic/19962914/followers",
       # "https://www.zhihu.com/topic/19562464/followers",
       # "https://www.zhihu.com/topic/20004843/followers",
       # "https://www.zhihu.com/topic/19624248/followers",
       # "https://www.zhihu.com/topic/19589741/followers",
       # "https://www.zhihu.com/topic/19671103/followers",
       # "https://www.zhihu.com/topic/19628366/followers",
       # "https://www.zhihu.com/topic/19594503/followers",
       # "https://www.zhihu.com/topic/20006863/followers",
       # "https://www.zhihu.com/topic/19555497/followers",
       # "https://www.zhihu.com/topic/19794133/followers",
       # "https://www.zhihu.com/topic/19560440/followers",
       # "https://www.zhihu.com/topic/19668659/followers",
       # "https://www.zhihu.com/topic/19918785/followers",
       # "https://www.zhihu.com/topic/19680208/followers",
       # "https://www.zhihu.com/topic/19774236/followers",
       # "https://www.zhihu.com/topic/19685766/followers",
       # "https://www.zhihu.com/topic/19561174/followers",
       # "https://www.zhihu.com/topic/19600907/followers",
       # "https://www.zhihu.com/topic/19608379/followers",
       # "https://www.zhihu.com/topic/19574671/followers",
       # "https://www.zhihu.com/topic/19834851/followers",
       # "https://www.zhihu.com/topic/19609341/followers",
       # "https://www.zhihu.com/topic/19672234/followers",
       # "https://www.zhihu.com/topic/19787019/followers",
       # "https://www.zhihu.com/topic/19573882/followers",
       # "https://www.zhihu.com/topic/19677421/followers",
       # "https://www.zhihu.com/topic/19794551/followers",
       # "https://www.zhihu.com/topic/19593973/followers",
       # "https://www.zhihu.com/topic/19835196/followers",
       # "https://www.zhihu.com/topic/19682811/followers",
       # "https://www.zhihu.com/topic/19773979/followers",
       # "https://www.zhihu.com/topic/19731189/followers",
       # "https://www.zhihu.com/topic/19590737/followers",
       # "https://www.zhihu.com/topic/19778739/followers",
       # "https://www.zhihu.com/topic/19554170/followers",
       # "https://www.zhihu.com/topic/19967946/followers",
       # "https://www.zhihu.com/topic/19845211/followers",
       # "https://www.zhihu.com/topic/19957561/followers",
       # "https://www.zhihu.com/topic/19774037/followers",
       # "https://www.zhihu.com/topic/19844398/followers",
       # "https://www.zhihu.com/topic/19855896/followers",
       # "https://www.zhihu.com/topic/19674331/followers",
       # "https://www.zhihu.com/topic/19838194/followers",
       # "https://www.zhihu.com/topic/19952767/followers",
       # "https://www.zhihu.com/topic/19799222/followers",
       # "https://www.zhihu.com/topic/19718465/followers",
       # "https://www.zhihu.com/topic/19763807/followers",
       # "https://www.zhihu.com/topic/19901767/followers",
       # "https://www.zhihu.com/topic/19809957/followers",
       # "https://www.zhihu.com/topic/19591027/followers",
       # "https://www.zhihu.com/topic/19568205/followers",
       # "https://www.zhihu.com/topic/19675237/followers",
       # "https://www.zhihu.com/topic/19662541/followers",
       # "https://www.zhihu.com/topic/19866277/followers",
       # "https://www.zhihu.com/topic/19774012/followers",
       # "https://www.zhihu.com/topic/19562149/followers",
       # "https://www.zhihu.com/topic/19673036/followers",
       # "https://www.zhihu.com/topic/19808791/followers",
       # "https://www.zhihu.com/topic/19631176/followers",
       # "https://www.zhihu.com/topic/19674351/followers",
       # "https://www.zhihu.com/topic/19705789/followers",
       # "https://www.zhihu.com/topic/19631519/followers",
       # "https://www.zhihu.com/topic/19817124/followers",
       # "https://www.zhihu.com/topic/19618407/followers",
       # "https://www.zhihu.com/topic/20001571/followers",
       # "https://www.zhihu.com/topic/19594501/followers",
       # "https://www.zhihu.com/topic/19669868/followers",
       # "https://www.zhihu.com/topic/19590534/followers",
       # "https://www.zhihu.com/topic/19607076/followers",
       # "https://www.zhihu.com/topic/19613580/followers",
       # "https://www.zhihu.com/topic/19776959/followers",
       # "https://www.zhihu.com/topic/19765262/followers",
       # "https://www.zhihu.com/topic/19839264/followers",
       # "https://www.zhihu.com/topic/19663999/followers",
       # "https://www.zhihu.com/topic/19600320/followers",
       # "https://www.zhihu.com/topic/19686079/followers",
       # "https://www.zhihu.com/topic/19835193/followers",
       # "https://www.zhihu.com/topic/19873587/followers",
       # "https://www.zhihu.com/topic/19946241/followers",
       # "https://www.zhihu.com/topic/19684934/followers",
       # "https://www.zhihu.com/topic/19551301/followers",
       # "https://www.zhihu.com/topic/19822409/followers",
       # "https://www.zhihu.com/topic/19855509/followers",
       # "https://www.zhihu.com/topic/19775396/followers",
       # "https://www.zhihu.com/topic/19661526/followers",
       # "https://www.zhihu.com/topic/19624887/followers",
       # "https://www.zhihu.com/topic/19600555/followers",
       # "https://www.zhihu.com/topic/19876303/followers",
       # "https://www.zhihu.com/topic/19633184/followers",
       # "https://www.zhihu.com/topic/19773952/followers",
       # "https://www.zhihu.com/topic/19798012/followers",
       # "https://www.zhihu.com/topic/19562344/followers",
       # "https://www.zhihu.com/topic/20005122/followers",
       # "https://www.zhihu.com/topic/19582841/followers",
       # "https://www.zhihu.com/topic/19786474/followers",
       # "https://www.zhihu.com/topic/19746659/followers",
       # "https://www.zhihu.com/topic/19810327/followers",
       # "https://www.zhihu.com/topic/19595006/followers",
       # "https://www.zhihu.com/topic/19730041/followers",
       # "https://www.zhihu.com/topic/20008543/followers",
       # "https://www.zhihu.com/topic/19553377/followers",
       # "https://www.zhihu.com/topic/20008543/followers",
       # "https://www.zhihu.com/topic/19553377/followers",
       # "https://www.zhihu.com/topic/19731867/followers",
       # "https://www.zhihu.com/topic/19863599/followers",
       # "https://www.zhihu.com/topic/19563443/followers",
       # "https://www.zhihu.com/topic/19553733/followers",
       # "https://www.zhihu.com/topic/19678626/followers",
       # "https://www.zhihu.com/topic/19679419/followers",
       # "https://www.zhihu.com/topic/19802134/followers",
       # "https://www.zhihu.com/topic/19889932/followers",
       # "https://www.zhihu.com/topic/19836531/followers",
       # "https://www.zhihu.com/topic/19859024/followers",
       # "https://www.zhihu.com/topic/19557447/followers",
       # "https://www.zhihu.com/topic/19552049/followers",
       # "https://www.zhihu.com/topic/19632881/followers",
       # "https://www.zhihu.com/topic/19683157/followers",
       # "https://www.zhihu.com/topic/19633003/followers",
       # "https://www.zhihu.com/topic/19775448/followers",
       # "https://www.zhihu.com/topic/19729613/followers",
       # "https://www.zhihu.com/topic/19681421/followers",
       # "https://www.zhihu.com/topic/19861290/followers",
       # "https://www.zhihu.com/topic/19858368/followers",
       # "https://www.zhihu.com/topic/19589799/followers",
       # "https://www.zhihu.com/topic/19618748/followers",
       # "https://www.zhihu.com/topic/20002213/followers",
       # "https://www.zhihu.com/topic/19684114/followers",
       # "https://www.zhihu.com/topic/19797116/followers",
       # "https://www.zhihu.com/topic/19568208/followers",
       # "https://www.zhihu.com/topic/19900131/followers",
       # "https://www.zhihu.com/topic/19642942/followers",
       # "https://www.zhihu.com/topic/19914332/followers",
       # "https://www.zhihu.com/topic/19947649/followers",
       # "https://www.zhihu.com/topic/19815794/followers",
       # "https://www.zhihu.com/topic/19652220/followers",
       # "https://www.zhihu.com/topic/19556199/followers",
       # "https://www.zhihu.com/topic/19962141/followers",
       # "https://www.zhihu.com/topic/19847656/followers",
       # "https://www.zhihu.com/topic/19846199/followers",
       # "https://www.zhihu.com/topic/19846199/followers",
       # "https://www.zhihu.com/topic/19734726/followers",
       # "https://www.zhihu.com/topic/19735076/followers",
       # "https://www.zhihu.com/topic/19840694/followers",
       # "https://www.zhihu.com/topic/19561552/followers",
       # "https://www.zhihu.com/topic/19871011/followers",
       # "https://www.zhihu.com/topic/19888995/followers",
       # "https://www.zhihu.com/topic/19663818/followers",
       # "https://www.zhihu.com/topic/19671071/followers",
       # "https://www.zhihu.com/topic/19878913/followers",
       # "https://www.zhihu.com/topic/19929200/followers",
       # "https://www.zhihu.com/topic/19607199/followers",
       # "https://www.zhihu.com/topic/19678795/followers",
       # "https://www.zhihu.com/topic/19863397/followers",
       # "https://www.zhihu.com/topic/19607201/followers",
       # "https://www.zhihu.com/topic/19893297/followers",
       # "https://www.zhihu.com/topic/19791657/followers",
       # "https://www.zhihu.com/topic/19814200/followers",
       # "https://www.zhihu.com/topic/19557110/followers",
       # "https://www.zhihu.com/topic/19557110/followers",
       # "https://www.zhihu.com/topic/19858396/followers",
       # "https://www.zhihu.com/topic/19793700/followers",
       # "https://www.zhihu.com/topic/19602437/followers",
       # "https://www.zhihu.com/topic/19723608/followers",
       # "https://www.zhihu.com/topic/19819668/followers",
       # "https://www.zhihu.com/topic/19869538/followers",
       # "https://www.zhihu.com/topic/19682960/followers",
       # "https://www.zhihu.com/topic/19877167/followers",
       # "https://www.zhihu.com/topic/19869317/followers",
       # "https://www.zhihu.com/topic/19667842/followers",
       # "https://www.zhihu.com/topic/20006810/followers",
       # "https://www.zhihu.com/topic/19773325/followers",
       # "https://www.zhihu.com/topic/19872649/followers",
       # "https://www.zhihu.com/topic/20009437/followers",
       # "https://www.zhihu.com/topic/19747620/followers",
       # "https://www.zhihu.com/topic/20011215/followers",
       # "https://www.zhihu.com/topic/19658241/followers",
       # "https://www.zhihu.com/topic/19925929/followers",
       # "https://www.zhihu.com/topic/19550877/followers",
       # "https://www.zhihu.com/topic/19920278/followers",
       # "https://www.zhihu.com/topic/19589518/followers",
       # "https://www.zhihu.com/topic/19697299/followers",
       # "https://www.zhihu.com/topic/20004836/followers",
       # "https://www.zhihu.com/topic/19641338/followers",
       # "https://www.zhihu.com/topic/19889364/followers",
       # "https://www.zhihu.com/topic/19827862/followers",
       # "https://www.zhihu.com/topic/19863589/followers",
       # "https://www.zhihu.com/topic/19860371/followers",
       # "https://www.zhihu.com/topic/19827918/followers",
       # "https://www.zhihu.com/topic/19864897/followers",
       # "https://www.zhihu.com/topic/19808264/followers",
       # "https://www.zhihu.com/topic/19933926/followers",
       # "https://www.zhihu.com/topic/19553404/followers",
       # "https://www.zhihu.com/topic/20007960/followers",
       # "https://www.zhihu.com/topic/19732064/followers",
       # "https://www.zhihu.com/topic/19935347/followers",
       # "https://www.zhihu.com/topic/19597882/followers",
       # "https://www.zhihu.com/topic/19812786/followers",
       # "https://www.zhihu.com/topic/19683885/followers",
       # "https://www.zhihu.com/topic/19580689/followers",
       # "https://www.zhihu.com/topic/19876376/followers",
       # "https://www.zhihu.com/topic/19675004/followers",
       # "https://www.zhihu.com/topic/19794711/followers",
       # "https://www.zhihu.com/topic/19860185/followers",
       # "https://www.zhihu.com/topic/19896734/followers",
       # "https://www.zhihu.com/topic/19750435/followers",
       # "https://www.zhihu.com/topic/19954125/followers",
       # "https://www.zhihu.com/topic/19595933/followers",
       # "https://www.zhihu.com/topic/19865386/followers",
       # "https://www.zhihu.com/topic/19916010/followers",
       # "https://www.zhihu.com/topic/19861532/followers",
       # "https://www.zhihu.com/topic/19793621/followers",
       # "https://www.zhihu.com/topic/19893608/followers",
       # "https://www.zhihu.com/topic/19900135/followers",
       # "https://www.zhihu.com/topic/19711478/followers",
       # "https://www.zhihu.com/topic/19732111/followers",
       # "https://www.zhihu.com/topic/19821265/followers",
       # "https://www.zhihu.com/topic/20006836/followers",
       # "https://www.zhihu.com/topic/19576971/followers",
       # "https://www.zhihu.com/topic/19816926/followers",
       # "https://www.zhihu.com/topic/20001530/followers",
       # "https://www.zhihu.com/topic/19608402/followers",
       # "https://www.zhihu.com/topic/19897762/followers",
       # "https://www.zhihu.com/topic/19670753/followers",
       # "https://www.zhihu.com/topic/19904648/followers",
       # "https://www.zhihu.com/topic/19689536/followers",
       # "https://www.zhihu.com/topic/19850346/followers",
       # "https://www.zhihu.com/topic/19821079/followers",
       # "https://www.zhihu.com/topic/19650063/followers",
       # "https://www.zhihu.com/topic/19884030/followers",
       # "https://www.zhihu.com/topic/19871029/followers",
       # "https://www.zhihu.com/topic/19663041/followers",
       # "https://www.zhihu.com/topic/19706499/followers",
       # "https://www.zhihu.com/topic/19767964/followers",
       # "https://www.zhihu.com/topic/19756458/followers",
       # "https://www.zhihu.com/topic/19579129/followers",
       # "https://www.zhihu.com/topic/19899401/followers",
       # "https://www.zhihu.com/topic/19832341/followers",
       # "https://www.zhihu.com/topic/19876402/followers",
       # "https://www.zhihu.com/topic/19963034/followers",
       # "https://www.zhihu.com/topic/19618993/followers",
       # "https://www.zhihu.com/topic/19638676/followers",
       # "https://www.zhihu.com/topic/20007426/followers",
       # "https://www.zhihu.com/topic/19785647/followers",
       # "https://www.zhihu.com/topic/19965814/followers",
       # "https://www.zhihu.com/topic/19647129/followers",
       # "https://www.zhihu.com/topic/20011267/followers",
       # "https://www.zhihu.com/topic/19654791/followers",
       # "https://www.zhihu.com/topic/19874751/followers",
       # "https://www.zhihu.com/topic/19924757/followers",
       # "https://www.zhihu.com/topic/20006263/followers",
       # "https://www.zhihu.com/topic/20006266/followers",
       # "https://www.zhihu.com/topic/19883913/followers",
       # "https://www.zhihu.com/topic/19650446/followers",
       # "https://www.zhihu.com/topic/19773528/followers",
       # "https://www.zhihu.com/topic/19859985/followers",
       # "https://www.zhihu.com/topic/19806013/followers",
       # "https://www.zhihu.com/topic/19695655/followers",
       # "https://www.zhihu.com/topic/19893937/followers",
       # "https://www.zhihu.com/topic/19707168/followers",
       # "https://www.zhihu.com/topic/19837885/followers",
       # "https://www.zhihu.com/topic/19660638/followers",
       # "https://www.zhihu.com/topic/19680325/followers",
       # "https://www.zhihu.com/topic/19847199/followers",
       # "https://www.zhihu.com/topic/19689160/followers",
       # "https://www.zhihu.com/topic/19746153/followers",
       # "https://www.zhihu.com/topic/19868629/followers",
       # "https://www.zhihu.com/topic/19708777/followers",
       # "https://www.zhihu.com/topic/20010284/followers",
       # "https://www.zhihu.com/topic/19684468/followers",
       # "https://www.zhihu.com/topic/19899783/followers",
       # "https://www.zhihu.com/topic/19642183/followers",
       # "https://www.zhihu.com/topic/19943508/followers",
       # "https://www.zhihu.com/topic/19894851/followers",
       # "https://www.zhihu.com/topic/19770618/followers",
       # "https://www.zhihu.com/topic/19673660/followers",
       # "https://www.zhihu.com/topic/19636972/followers",
       # "https://www.zhihu.com/topic/19754584/followers",
       # "https://www.zhihu.com/topic/19644438/followers",
       # "https://www.zhihu.com/topic/19927364/followers",
       # "https://www.zhihu.com/topic/19805284/followers",
       # "https://www.zhihu.com/topic/20008425/followers",
       # "https://www.zhihu.com/topic/19670443/followers",
       # "https://www.zhihu.com/topic/19870330/followers",
       # "https://www.zhihu.com/topic/19874436/followers",
       # "https://www.zhihu.com/topic/19924359/followers",
       # "https://www.zhihu.com/topic/19943297/followers",
       # "https://www.zhihu.com/topic/19900644/followers",
       # "https://www.zhihu.com/topic/19964179/followers",
       # "https://www.zhihu.com/topic/19833049/followers",
       # "https://www.zhihu.com/topic/19663820/followers",
       # "https://www.zhihu.com/topic/19928427/followers",
       # "https://www.zhihu.com/topic/19947539/followers",
       # "https://www.zhihu.com/topic/19849875/followers",
       # "https://www.zhihu.com/topic/19936061/followers",
       # "https://www.zhihu.com/topic/19856541/followers",
       # "https://www.zhihu.com/topic/19856752/followers",
       # "https://www.zhihu.com/topic/19666181/followers",
       # "https://www.zhihu.com/topic/20004223/followers",
       # "https://www.zhihu.com/topic/19856990/followers",
       # "https://www.zhihu.com/topic/19845336/followers",
       # "https://www.zhihu.com/topic/19937736/followers",
       # "https://www.zhihu.com/topic/19667840/followers",
       # "https://www.zhihu.com/topic/20006419/followers",
       # "https://www.zhihu.com/topic/19794771/followers",
       # "https://www.zhihu.com/topic/19856376/followers",
       # "https://www.zhihu.com/topic/19656322/followers",
       # "https://www.zhihu.com/topic/20006842/followers",
       # "https://www.zhihu.com/topic/19797758/followers",
       # "https://www.zhihu.com/topic/19909120/followers",
       # "https://www.zhihu.com/topic/19904483/followers",
       # "https://www.zhihu.com/topic/19792718/followers",
       # "https://www.zhihu.com/topic/20009532/followers",
       # "https://www.zhihu.com/topic/19672230/followers",
       # "https://www.zhihu.com/topic/19912030/followers",
       # "https://www.zhihu.com/topic/19848945/followers",
       # "https://www.zhihu.com/topic/19838376/followers",
       # "https://www.zhihu.com/topic/19844982/followers",
       # "https://www.zhihu.com/topic/20004837/followers",
       # "https://www.zhihu.com/topic/20004841/followers",
       # "https://www.zhihu.com/topic/19618398/followers",
       # "https://www.zhihu.com/topic/19612762/followers",
       # "https://www.zhihu.com/topic/19821668/followers",
       # "https://www.zhihu.com/topic/19557752/followers",
       # "https://www.zhihu.com/topic/19914334/followers",
       # "https://www.zhihu.com/topic/19920712/followers",
       # "https://www.zhihu.com/topic/20006857/followers",
       # "https://www.zhihu.com/topic/19890755/followers",
       # "https://www.zhihu.com/topic/19878405/followers",
       # "https://www.zhihu.com/topic/19878894/followers",
       # "https://www.zhihu.com/topic/19593853/followers",
       # "https://www.zhihu.com/topic/19731438/followers",
       # "https://www.zhihu.com/topic/20009181/followers",
       # "https://www.zhihu.com/topic/20011559/followers",
       # "https://www.zhihu.com/topic/19665450/followers",
       # "https://www.zhihu.com/topic/19832362/followers",
       # "https://www.zhihu.com/topic/19683907/followers",
       # "https://www.zhihu.com/topic/19635890/followers",
       # "https://www.zhihu.com/topic/19943446/followers",
       # "https://www.zhihu.com/topic/19943491/followers",
       # "https://www.zhihu.com/topic/19676899/followers",
       # "https://www.zhihu.com/topic/20011270/followers",
       # "https://www.zhihu.com/topic/20011412/followers",
       # "https://www.zhihu.com/topic/20011584/followers",
       # "https://www.zhihu.com/topic/20006845/followers",
       # "https://www.zhihu.com/topic/19680278/followers",
       # "https://www.zhihu.com/topic/19631334/followers",
       # "https://www.zhihu.com/topic/19847179/followers",
       # "https://www.zhihu.com/topic/20006852/followers",
       # "https://www.zhihu.com/topic/19657731/followers",
       # "https://www.zhihu.com/topic/19928463/followers",
       # "https://www.zhihu.com/topic/19848685/followers",
       # "https://www.zhihu.com/topic/20009159/followers",
       # "https://www.zhihu.com/topic/19637789/followers",
       # "https://www.zhihu.com/topic/19640927/followers",
       # "https://www.zhihu.com/topic/19791411/followers",
       # "https://www.zhihu.com/topic/19868910/followers",
       # "https://www.zhihu.com/topic/19893938/followers",
       # "https://www.zhihu.com/topic/19727756/followers",
       # "https://www.zhihu.com/topic/19794453/followers",
       # "https://www.zhihu.com/topic/19727855/followers",
       # "https://www.zhihu.com/topic/19611927/followers",
       # "https://www.zhihu.com/topic/20011650/followers",
       # "https://www.zhihu.com/topic/19870505/followers",
       # "https://www.zhihu.com/topic/19569598/followers",
       # "https://www.zhihu.com/topic/19747635/followers",
       # "https://www.zhihu.com/topic/19783222/followers",
       # "https://www.zhihu.com/topic/19920507/followers",
       # "https://www.zhihu.com/topic/20006661/followers",
       # "https://www.zhihu.com/topic/19915462/followers",
       # "https://www.zhihu.com/topic/19790942/followers",
       # "https://www.zhihu.com/topic/19913903/followers",
       # "https://www.zhihu.com/topic/19731239/followers",
       # "https://www.zhihu.com/topic/20007966/followers",
       # "https://www.zhihu.com/topic/19848294/followers",
       # "https://www.zhihu.com/topic/19922192/followers",
       # "https://www.zhihu.com/topic/19621265/followers",
       # "https://www.zhihu.com/topic/19902933/followers",
       # "https://www.zhihu.com/topic/19902933/followers",
       # "https://www.zhihu.com/topic/19554178/followers",
       # "https://www.zhihu.com/topic/19615491/followers",
       # "https://www.zhihu.com/topic/19873690/followers",
       # "https://www.zhihu.com/topic/20002689/followers",
       # "https://www.zhihu.com/topic/19855424/followers",
       # "https://www.zhihu.com/topic/20002916/followers",
       # "https://www.zhihu.com/topic/19769568/followers",
       # "https://www.zhihu.com/topic/19856249/followers",
       # "https://www.zhihu.com/topic/19826295/followers",
       # "https://www.zhihu.com/topic/19734061/followers",
       # "https://www.zhihu.com/topic/19734061/followers",
    ]
    password = 'GUOXINpeng123'
    email = ''
    phone = '15210227674'
    headers = {
        'Accept' : 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
        'Accept-Encoding':'gzip, deflate, sdch, br',
        'Accept-Language':'zh-CN,zh;q=0.8,en;q=0.6',
        'Cache-Control':'max-age=0',
        'Connection':'keep-alive',
        'Host':'www.zhihu.com',
        'Upgrade-Insecure-Requests':'1',
        'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36',
        "Referer": "https://www.zhihu.com",
        "Origin" : "https://www.zhihu.com"
    }

    def start_requests(self):
        yield scrapy.Request(url = "http://www.zhihu.com/#signin", meta = {'cookiejar':1}, headers = self.headers, callback = self.post_login)
        #重写了爬虫类的方法, 实现了自定义请求, 运行成功后会调用callback回调函数

    def post_login(self, response):
        xsrf = response.css('input[name=_xsrf]::attr("value")')[0].extract()
        if self.phone:
            return scrapy.FormRequest(
                'http://www.zhihu.com/login/phone_num',
                meta={'cookiejar': response.meta['cookiejar']},
                formdata={'_xsrf': xsrf, 'password': self.password, 'remember_me' : "True", 'phone_num':self.phone},
                callback=self.set_refer,
                dont_filter=True
            )
        else:
            return scrapy.FormRequest(
                'http://www.zhihu.com/login/email',
                meta={'cookiejar': response.meta['cookiejar']},
                formdata={'_xsrf': xsrf, 'password': self.password, 'captcha_type': 'cn', 'remember_me' : "True", 'email':self.email},
                callback=self.set_refer,
                dont_filter=True
            )

    def set_refer(self, response):
        print '--------------------set_refer------------------'
        for i in self.start_urls:
            yield scrapy.Request(url = i, meta = {'cookiejar': 1},  callback=self.parse_follower)

    def parse_follower(self, response):
        scrapy_url = response.url
        print 'parse topic follower'
        urls = response.css('.zm-list-avatar-medium::attr("href")').extract()
        self.parse_urls(urls)
        time.sleep(randint(1, 2))
        print 'start topic json'
        xsrf = response.css('input[name=_xsrf]::attr("value")')[0].extract()
        headers = self.headers
        headers['X-Xsrftoken'] = xsrf
        print 'start  offset  end'
        self.start = response.css('.zm-person-item::attr("id")')[-1].extract().encode('utf-8')[3:]
        self.offset = 40
        self.end = False

        if self.offset > 10000 :
            yield 'finished'

        while (self.offset < 10000) :
            print 'request json'
            time.sleep(randint(1, 2))
            yield scrapy.FormRequest(
                url = scrapy_url,
                meta = {'cookiejar': response.meta['cookiejar']},
                formdata = {'offset' : str(self.offset), 'start' : self.start},
                callback = self.parse_json,
                headers = headers,
                dont_filter = True
            )

    def parse_json(self, response):
        print 'parsing '
        print response.url
        print self.start
        print self.offset
        jsonresponse = json.loads(response.body_as_unicode())
        body = jsonresponse['msg'][1]
        if jsonresponse['msg'][0] < 20:
            self.end = True
        self.offset = self.offset + 20
        self.start = Selector(text=body).css('.zm-person-item::attr("id")')[-1].extract().encode('utf-8')[3:]
        urls = Selector(text=body).css('.zm-list-avatar-medium::attr("href")').extract()
        yield self.parse_urls(urls)

    def parse_urls(self, urls):
        write_db = DB(MySQL['db_host'], MySQL['db_port'], MySQL['db_user'], MySQL['db_password'], MySQL['db_dbname']) 
        for i in urls:
            sql = """insert ignore into url(url) values (%s)"""
            print """insert ignore into url(url) values ('"""+ i  +"""')"""
            resQuery = write_db.execute(sql, (i))
        write_db.__delete__()

    def parse_item(self, response):
        print 'parsing response  ', response.url
        zhihu_item = ZhiHuItem()
        zhihu_item['id'] = response.css('.zm-rich-follow-btn::attr("data-id")').extract()
        zhihu_item['name'] = response.css('.title-section  .name::text').extract()
        zhihu_item['avatar'] = response.css('.zm-profile-header-main  .Avatar::attr("src")').extract()
        zhihu_item['remark'] = response.css('.title-section  .bio::text').extract()
        zhihu_item['agree'] = response.css('.zm-profile-header-user-agree  strong::text').extract()
        zhihu_item['thanks'] = response.css('.zm-profile-header-user-thanks  strong::text').extract()
        zhihu_item['location'] = response.css('.zm-profile-header-user-describe .items .info-wrap .location::attr("title")').extract()
        zhihu_item['business'] = response.css('.zm-profile-header-user-describe .items .info-wrap .business::attr("title")').extract()
        zhihu_item['gender'] = response.css('.zm-profile-header-user-describe .items .edit-wrap input[checked=checked]::attr("value")').extract()
        zhihu_item['employment'] = response.css('.zm-profile-header-user-describe .items .info-wrap .employment::attr("title")').extract()
        zhihu_item['education'] = response.css('.zm-profile-header-user-describe .items .education::attr("title")').extract()
        zhihu_item['education_extra'] = response.css('.zm-profile-header-user-describe .items .education-extra::attr("title")').extract()
        zhihu_item['asks'] = response.css('.profile-navbar a[href*=asks] span::text').extract()
        zhihu_item['answers'] = response.css('.profile-navbar a[href*=answers] span::text').extract()
        zhihu_item['posts'] = response.css('.profile-navbar a[href*=posts] span::text').extract()
        zhihu_item['collections'] = response.css('.profile-navbar a[href*=collections] span::text').extract()
        zhihu_item['logs'] = response.css('.profile-navbar a[href*=logs] span::text').extract()
        print '=============================================================================================================='
        zhihu_item['id'] = zhihu_item['id'][0].encode('utf-8') if zhihu_item['id'] else 0
        zhihu_item['name'] = zhihu_item['name'][0].encode('utf-8') if zhihu_item['name'] else 0
        zhihu_item['avatar'] = zhihu_item['avatar'][0].encode('utf-8') if zhihu_item['avatar'] else 0
        zhihu_item['remark'] = zhihu_item['remark'][0].encode('utf-8') if zhihu_item['remark'] else 0
        zhihu_item['agree'] = zhihu_item['agree'][0].encode('utf-8') if zhihu_item['agree'] else 0
        zhihu_item['thanks'] = zhihu_item['thanks'][0].encode('utf-8') if zhihu_item['thanks'] else 0
        zhihu_item['location'] = zhihu_item['location'][0].encode('utf-8') if zhihu_item['location'] else 0
        zhihu_item['business'] = zhihu_item['business'][0].encode('utf-8') if zhihu_item['business'] else 0
        zhihu_item['gender'] = zhihu_item['gender'][0].encode('utf-8') if zhihu_item['gender'] else 0
        zhihu_item['employment'] = zhihu_item['employment'][0].encode('utf-8') if zhihu_item['employment'] else 0
        zhihu_item['education'] = zhihu_item['education'][0].encode('utf-8') if zhihu_item['education'] else 0
        zhihu_item['education_extra'] = zhihu_item['education_extra'][0].encode('utf-8') if zhihu_item['education_extra'] else 0
        zhihu_item['asks'] = zhihu_item['asks'][0].encode('utf-8') if zhihu_item['asks'] else 0
        zhihu_item['answers'] = zhihu_item['answers'][0].encode('utf-8') if zhihu_item['answers'] else 0
        zhihu_item['posts'] = zhihu_item['posts'][0].encode('utf-8') if zhihu_item['posts'] else 0
        zhihu_item['collections'] = zhihu_item['collections'][0].encode('utf-8') if zhihu_item['collections'] else 0
        zhihu_item['logs'] = zhihu_item['logs'][0].encode('utf-8') if zhihu_item['logs'] else 0
        
        if zhihu_item['id']:
           print '----> db <----'
           write_db = DB(MySQL['db_host'], MySQL['db_port'], MySQL['db_user'], MySQL['db_password'], MySQL['db_dbname']) 
           sql = """insert ignore into user (u_id, name, avatar, remark, agree, thanks, location, business, gender, employment, education, education_extra, asks, answers, posts, collections, logs, url) values (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)"""
           resQuery = write_db.execute(sql, (zhihu_item['id'], zhihu_item['name'], zhihu_item['avatar'], zhihu_item['remark'], zhihu_item['agree'], zhihu_item['thanks'], zhihu_item['location'], zhihu_item['business'], zhihu_item['gender'], zhihu_item['employment'], zhihu_item['education'], zhihu_item['education_extra'], zhihu_item['asks'], zhihu_item['answers'], zhihu_item['posts'], zhihu_item['collections'], zhihu_item['logs'], response.url))
           write_db.__delete__()
           print 'resQuery -------   ', resQuery
